\documentclass{article}
\usepackage[cm]{fullpage}
\usepackage{graphicx}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{enumerate}
\usepackage{float}
\restylefloat{table}
\usepackage{listings}
\usepackage{color}
\usepackage{fancybox}
%%\usepackage{tikz}
%%\usetikzlibrary{arrows,chains,matrix,positioning,scopes,backgrounds}
\usepackage[USenglish]{isodate}
\isodate
\usepackage{fancyhdr}
\pagestyle{fancy}
\headheight 10pt
\headsep 10pt
\rhead{\today}
\chead{EE 141 Project}
\lhead{Nathan Aclander and Troy Sankey}
\cfoot{\thepage}

\title{Hard Disk Drive (HDD) Read Header Controller Design}
\date{\today}
\author{Nathan Aclander (903933664) and Troy Sankey (403942345)}

\begin{document}

\maketitle
\newpage

\section*{Summary of Objectives}

\section*{Project Tasks}
\subsection*{Task 1: Deriving the Transfer Function}

In this task we are to derive the transfer function $G_2(s) =
\frac{Y(s)}{U(s)}$ of the head reader position model. This relates the
input torque $u(t)$ to the head position $y(t)$. To do this we will
use the Laplace Transform as learned in class to get the desired
transfer function.

We know our initial conditions for $\dot{y}$ and $\ddot{y}$ are $0$
because the HDD head is not in motion.

\begin{align*}
  \dot{y} &= 0 \\
  \ddot{y} &= 0 \\
  \mathcal{L}\left\{ J\ddot{y} + b \dot{y}\right\} &= \mathcal{L}\left\{u(t)\right\} \\
  Js^2 Y(s) + bsY(s) &= U(s) \\
  G_2 &= \frac{Y(s)}{U(s)} = \frac{\frac{1}{b}}{s(\frac{J}{b}s + 1)} \\
\end{align*}

Calculating the Laplace Transform of the torque to position
relationship was relatively easy as shown above. We used differential
equation solving techniques learned in class, and are now ready to
apply this transfer function in the remaining tasks of this project.

\subsection*{Task 2: Calculating the Open-Loop Transfer Function}

In this task we are to calculate the open-loop transfer function of
the cascaded HDD head reader assembly, and additionally obtain the
unit step response plot. The first function of our cascaded system was
given to us in the project specification. It is the transfer function
of the motor coil that relates the input voltage to the output torque,
it is shown below:

$$G_1(s) = \frac{U(s)}{V(s)} = \frac{K_m}{Ls + R}$$

To calculate the open-loop transfer function we relied on the fact
that the cascaded transfer function is $G_1$ and $G_2$ multiplied
together, as learned in class. The cascaded open-loop transfer
function is shown below:

\begin{align*}
  G_1G_2 &= \frac{K_m}{Ls+R} \cdot \frac{\frac{1}{b}}{s(\frac{J}{b}s + 1)} \\
         &= \frac{\frac{K_m}{bR}}{s\left(\frac{J}{b}s + 1\right)  \left(\frac{L}{R}s + 1\right)} \\
         &= \frac{1}{\frac{JL}{K_m}s^3 + s^2\left( \frac{RJ}{K_m} + \frac{bL}{K_m} \right) + \frac{bR}{K_m}s}
\end{align*}

The second part of this task asked us to take the unit step response
of the open-loop transfer function we just derived. The project
specification mentioned to use the values from the table below:

%TODO maybe make the first row Bold?%
\begin{table}[H]
  \begin{center}
    \begin{tabular}{ | l | l | l | p{5cm} |}
    \hline
    Parameter & Symbol & Typical Value \\ \hline
    Inertia of arm and head & $J$ & 1 N $\cdot$ m s$^2$/rad \\ \hline 
    Friction & $b$ & 20 kg/m/s \\ \hline
    Field Resistance & $R$ & 1 $\Omega$ \\ \hline
    Field Inductance & $L$ & 0.001 H \\ \hline
    Motor Constant & $K_m$ & 1 N $\cdot$ m/A \\ \hline
   \end{tabular}
 \end{center}
 \caption{Model Parameters}
 \label{table:param}
\end{table}

After pluging in our values from the table into our transfer function
equation we get the following:

$$\frac{1}{0.001s^3 + 1.02 s^2 + 20s}$$

And our Octave code and plot of the impulse response is shown below:

%Octave source code as required by project specification.
%\hspace{5em}
%\begin{minipage}
\lstinputlisting[language=Matlab,
                 breaklines=true,
                 morekeywords={matlab2tikz},
                 numbers=left,
                 numberstyle={\tiny \color{black}},
                 keywordstyle=\color{blue},
                 showstringspaces=false,
                 numbersep=9pt,
                 xleftmargin=3em
                ]{fig1.m}
%\end{minipage}

\begin{figure}[H]
  \caption{Open-loop transfer function of the cascaded HDD head reader
    assembly}
  \centering
  \includegraphics[width=0.5\textwidth]{fig1.eps}
\end{figure}

In conclusion we were able to derive and expression for the open-loop
transfer function by cascading the head reader position model and the
motor coil transfer function together. We then observed, using Octave,
the step response on our new transfer function using the provided
model parameters.

\subsection*{Task 3: Proportional Compensator}

This task required us to find the step response of the closed-loop system to
the unit step refrence input, while assuming zero disturbance. To complete the
closed loop we were given the sensor's transfer function $H(s) = 1$ and the
candidate controller $F(s) = K_a$. This task relies on our understanding on
block diagrams as explained in class, as well as application of compensator
design given transient response performance specifications.

\subsubsection*{Task 3A: Responses: Unit Step Refrence Input}

%TODO Maybe show block diagram?

Our closed-loop is represented as: 

$$HDD(s) = \frac{F(s)G_1(s)G_2(s)}{1 + F(s)G_1(s)G_2(s)}$$

Where $G_1(s)G_2(s)$ is the transfer function from part 2. Using the two 
specified values for $K_a$ we get the following transfer function when using
values from Table 1.

\begin{table}[H]
\begin{center}
  \begin{tabular}{ | l | l | l | p{5cm} |}
  \hline
  $K_a$ & $HDD(s)$  \\ \hline
  50 & $\frac{0.05s^3 + 41s^2 + 1000s}{0.00204s^5 1.08s^4 + 40.85 s^3 
  + 451 s^2  + 1000s}$\\ \hline 
  400 & $\frac{0.4s^3 + 408s^2 + 8000s}{0.00204s^5 + 1.08s^4 + 41.2 s^3
  + 808 s^2 + 8000 s}$  \\ \hline
 \end{tabular}
\end{center}
\caption{Closed-Loop System: Unit Step Refrence Input}
\label{table:2}
\end{table}

Using Octave, we observed the response to the unit step refrence input. The
Octave code and plots are shown below. 

\lstinputlisting[language=Matlab,
                 breaklines=true,
                 morekeywords={matlab2tikz},
                 numbers=left,
                 numberstyle={\tiny \color{black}},
                 keywordstyle=\color{blue},
                 showstringspaces=false,
                 numbersep=9pt,
                 xleftmargin=3em
                ]{fig2.m}
%\end{minipage}

\begin{figure}[H]
  \caption{Step response for the closed loop system: $K_a = 50$}
  \centering
  \includegraphics[width=0.5\textwidth]{fig2.eps}
\end{figure}

\lstinputlisting[language=Matlab,
                 breaklines=true,
                 morekeywords={matlab2tikz},
                 numbers=left,
                 numberstyle={\tiny \color{black}},
                 keywordstyle=\color{blue},
                 showstringspaces=false,
                 numbersep=9pt,
                 xleftmargin=3em
                ]{fig3.m}
%\end{minipage}

\begin{figure}[H]
  \caption{Step response for the closed loop system: $K_a = 400$}
  \centering
  \includegraphics[width=0.5\textwidth]{fig3.eps}
\end{figure}

\subsubsection*{Task 3B: Responses: Unit Step Disturbance}

%TODO Maybe show block diagram?

Our closed-loop is represented as: 

$$ HDD(s) = \frac{G_2(s)}{1 + G_1(s)H(s)F(s)G_2(s)} $$ 

Again, using the specifications for part 2 we get:

\begin{table}[H]
\begin{center}
  \begin{tabular}{ | l | l | l | p{5cm} |}
  \hline
  $K_a$ & $HDD(s)$  \\ \hline
  50 & $\frac{0.00255s^2 + 0.05s}{0.0026s^4 + 0.101s^3 + 1.125s^2 + 2.5s}$\\ \hline 
  400 & $\frac{0.00255s^2 + 0.05s}{0.0026s^4 + 0.101s^3 + 2s^2 + 20s}$\\ \hline 
 \end{tabular}
\end{center}
\caption{Closed-Loop System: Unit Step Disturbance}
\label{table:3}
\end{table}

Using Octave, we observed the response to the unit step refrence input. The
Octave code and plots are shown below. 

\lstinputlisting[language=Matlab,
                 breaklines=true,
                 morekeywords={matlab2tikz},
                 numbers=left,
                 numberstyle={\tiny \color{black}},
                 keywordstyle=\color{blue},
                 showstringspaces=false,
                 numbersep=9pt,
                 xleftmargin=3em
                ]{fig4.m}
%\end{minipage}

\begin{figure}[H]
  \caption{Step response for the closed loop system: $K_a = 50$}
  \centering
  \includegraphics[width=0.5\textwidth]{fig4.eps}
\end{figure}

\lstinputlisting[language=Matlab,
                 breaklines=true,
                 morekeywords={matlab2tikz},
                 numbers=left,
                 numberstyle={\tiny \color{black}},
                 keywordstyle=\color{blue},
                 showstringspaces=false,
                 numbersep=9pt,
                 xleftmargin=3em
                ]{fig5.m}
%\end{minipage}

\begin{figure}[H]
  \caption{Step response for the closed loop system: $K_a = 400$}
  \centering
  \includegraphics[width=0.5\textwidth]{fig5.eps}
\end{figure}

\subsubsection*{Task 3C: Satisfying the Performance Specifications}

For this subtask, a value for $K_a$ was needed to meet performance 
specifications of the system. The specifications are shown inthe table below.

\begin{table}[H]
\begin{center}
  \begin{tabular}{ | l | l | l | p{5cm} |}
  \hline
  Percent Measure & Specification\\ \hline 
  Percent overshoot & Less than $5\%$ \\ \hline 
  Settling time ($2\%$ deviation) & Less than 250 ms \\ \hline 
  Maximum Value of response to a unit step disturbance & Less than 
  $5\cdot10^{-3}$ \\ \hline 
  Percent overshoot & Less than $5\%$ \\ \hline 
 \end{tabular}
\end{center}
\caption{Transient Response Performance Specifications}
\label{table:3}
\end{table}

After observing the response of the system for varying values of $K_a$ we
concluded that it was not possible to meet all aspects of the specifications
from the proportional compensator. 

The shortest settling time we could get was approximatley 0.37 seconds, for
$K_a = 1450$. We noticed a parabolic relationship between $K_a$ and the
settling time. Values smaller, and larger than $K_a = 1450$ gave longer
settling times. Settling time seemed to be the smallest at approximatley
$K_a = 1450$.

To meet the appropriate overshoot, we set $K_a$ to 200, which
indeed did place the system within the correct specification margins for
overshoot, but placed it outside the bound of the maximum value of the response
 to a unit step disturbance. Increasing $K_a$ higher brought the system
closer to meeting the specification for the maximum bound, but further away from
meeting the overshoot specification. $K_a = 220$ for example, gave a maximum
value just under the required $5\cdot10^{-3}$.

%TODO show graphs that help explain?

In conclusion, this task required building a complete mathematical model for
the HDD Read Head system, and then using this model to meet required
specifications. This task also showed, however, that adding a compensator will
not neccessarilly change the system to meet all specifications. In part C of
this task, we saw that when adding a compensator we were able to meet certain
specification requirements, but never all of them. This task made an important
observation in showing not all compensators are the same, as tasks later on
will show.

%% \begin{itemize}
%% 
%% \item[Task 3]
%% 
%%   \begin{enumerate}[A]
%%   \item
%%   \item
%%   \item
%%   \end{enumerate}
%% 
%% \item[Task 4]
%% \item[Task 5]
%% \item[Task 6]
%% 
%%   \begin{enumerate}[A]
%%   \item
%%   \item
%%   \item
%%   \item
%%   \end{enumerate}
%% 
%% \end{itemize}

\end{document}
